<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Selector</title>
    <!-- Include Tailwind CSS for styling -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #3498db;
            animation: spin 1s ease-in-out infinite;
            -webkit-animation: spin 1s ease-in-out infinite;
        }
    
        .loading-text {
            margin-top: 10px;
        }

        .form-select {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 0.25rem;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            line-height: 1.25;
        }

        .form-checkbox {
            accent-color: #3498db;
        }

        .form-button {
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 0.25rem;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            line-height: 1.25;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .form-button:hover {
            background-color: #287ab8;
        }

        .table-header {
            background-color: #f1f5f9;
            color: #334155;
        }

        .table-row {
            background-color: #ffffff;
            color: #475569;
        }

        .container {
            max-width: 1200px; /* You can set this to the max width you prefer */
            margin-left: auto;
            margin-right: auto;
        }

        /* Add some padding on the left and right for when the window is smaller than max-width */
        @media (max-width: 1200px) {
            .container {
                padding-left: 15px;
                padding-right: 15px;
            }
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Navigation Bar -->
    <nav class="bg-white shadow mb-8">
        <div class="container mx-auto px-4 py-4">
            <div class="text-center text-2xl font-bold">GeneratEd</div>
        </div>
    </nav>
    <div class="container mx-auto p-4">
        <!-- Form to input parameters for results -->
        <div class="mb-4 bg-white p-4 rounded shadow">
            <form id="course-form">
                <div class="mb-2">
                    <label class="block font-bold">GenEd Requirement:</label>
                    <div class="flex flex-wrap gap-2">
                        <label class="flex items-center"><input type="checkbox" name="gen_ed_requirement" value="ACP" class="mr-2">ACP</label>
                        <label class="flex items-center"><input type="checkbox" name="gen_ed_requirement" value="HP" class="mr-2">HP</label>
                        <label class="flex items-center"><input type="checkbox" name="gen_ed_requirement" value="LA" class="mr-2">LA</label>
                        <label class="flex items-center"><input type="checkbox" name="gen_ed_requirement" value="BSC" class="mr-2">BSC</label>
                        <label class="flex items-center"><input type="checkbox" name="gen_ed_requirement" value="SS" class="mr-2">SS</label>
                        <label class="flex items-center"><input type="checkbox" name="gen_ed_requirement" value="LS" class="mr-2">LS</label>
                        <label class="flex items-center"><input type="checkbox" name="gen_ed_requirement" value="PS" class="mr-2">PS</label>
                        <label class="flex items-center"><input type="checkbox" name="gen_ed_requirement" value="NW" class="mr-2">NW</label>
                        <label class="flex items-center"><input type="checkbox" name="gen_ed_requirement" value="US" class="mr-2">US</label>
                        <label class="flex items-center"><input type="checkbox" name="gen_ed_requirement" value="WCC" class="mr-2">WCC</label>
                    </div>
                </div>  
                <div class="mb-2 flex justify-start gap-2 items-end">
                    <div>
                        <label class="block font-bold">Start Time:</label>
                        <select name="start_hour" class="p-2 border rounded">
                            <!-- Hour options -->
                            <option value="01">1</option>
                            <option value="02">2</option>
                            <option value="03">3</option>
                            <option value="04">4</option>
                            <option value="05">5</option>
                            <option value="06">6</option>
                            <option value="07">7</option>
                            <option value="08">8</option>
                            <option value="09">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                        </select>
                    </div>
                    <div>
                        <label class="inline-block font-bold">:</label>
                        <select name="start_minute" class="p-2 border rounded">
                            <!-- Minute options -->
                            <option value="00">00</option>
                            <option value="15">15</option>
                            <option value="30">30</option>
                            <option value="45">45</option>
                        </select>
                    </div>
                    <div>
                        <select name="start_ampm" class="p-2 border rounded">
                            <!-- AM/PM options -->
                            <option value="AM">AM</option>
                            <option value="PM">PM</option>
                        </select>
                    </div>
                </div>
                
                <div class="mb-2 flex justify-start gap-2 items-end">
                    <div>
                        <label class="block font-bold">End Time:</label>
                        <select name="end_hour" class="p-2 border rounded">
                            <!-- Hour options -->
                            <option value="01">1</option>
                            <option value="02">2</option>
                            <option value="03">3</option>
                            <option value="04">4</option>
                            <option value="05">5</option>
                            <option value="06">6</option>
                            <option value="07">7</option>
                            <option value="08">8</option>
                            <option value="09">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                        </select>
                    </div>
                    <div>
                        <label class="inline-block font-bold">:</label>
                        <select name="end_minute" class="p-2 border rounded">
                            <!-- Minute options -->
                            <option value="00">00</option>
                            <option value="15">15</option>
                            <option value="30">30</option>
                            <option value="45">45</option>
                        </select>
                    </div>
                    <div>
                        <select name="end_ampm" class="p-2 border rounded">
                            <!-- AM/PM options -->
                            <option value="AM">AM</option>
                            <option value="PM">PM</option>
                        </select>
                    </div>
                </div>
                <div class="mb-2">
                    <label class="block font-bold">Day:</label>
                    <select name="day" class="w-full p-2 border rounded">
                        <option value="Monday">Monday</option>
                        <option value="Tuesday">Tuesday</option>
                        <option value="Wednesday">Wednesday</option>
                        <option value="Thursday">Thursday</option>
                        <option value="Friday">Friday</option>
                    </select>
                </div>
                <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                    Get Courses
                </button>
            </form>
        </div>
        
        <!-- Section for the courses table -->
        <div id="courses-section" class="mt-4 bg-white p-4 rounded shadow">
            <h2 class="text-xl font-semibold mb-4">Courses</h2>
            <!-- Loading Indicator (initially hidden) -->
            <div id="loading" class="hidden text-center py-4">
                <div class="loading-spinner"></div>
                <div class="loading-text">Loading...</div>
            </div>
            <div id="courses-container">
            </div>
        </div>
    </div>

    <!-- GenEd Requirements Table -->
    <div class="container mx-auto p-4 mb-4">
        <h2 class="text-xl font-semibold mb-4">GenEd Requirement Codes</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full leading-normal">
                <thead>
                    <tr>
                        <th class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                            Code
                        </th>
                        <th class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                            Title
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">ACP</td>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">Advanced Composition</td>
                    </tr>
                    <tr>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">HP</td>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">Historical and Philosophical Perspectives</td>
                    </tr>
                    <tr>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">LA</td>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">Literature and the Arts</td>
                    </tr>
                    <tr>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">BSC</td>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">Behavioral Sciences</td>
                    </tr>
                    <tr>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">SS</td>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">Social Sciences</td>
                    </tr>
                    <tr>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">LS</td>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">Life Sciences</td>
                    </tr>
                    <tr>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">PS</td>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">Physical Sciences</td>
                    </tr>
                    <tr>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">NW</td>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">Non-Western Cultures</td>
                    </tr>
                    <tr>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">US</td>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">US Minority Cultures</td>
                    </tr>
                    <tr>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">WCC</td>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">Western/Comparative Cultures</td>
                    </tr>
                    <tr>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">QR1</td>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">Quantitative Reasoning I</td>
                    </tr>
                    <tr>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">QR2</td>
                        <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">Quantitative Reasoning II</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        document.getElementById('course-form').addEventListener('submit', function(event) {
            event.preventDefault();

            const loadingIndicator = document.getElementById('loading');
            const coursesContainer = document.getElementById('courses-container');

            if (loadingIndicator) {
                loadingIndicator.classList.remove('hidden');
            }

            coursesContainer.innerHTML = '';

            // Construct start and end time strings
            const startTime = `${this.start_hour.value}:${this.start_minute.value} ${this.start_ampm.value}`;
            const endTime = `${this.end_hour.value}:${this.end_minute.value} ${this.end_ampm.value}`;

            // Construct FormData
            const formData = new FormData();
            formData.append('start_time', startTime);
            formData.append('end_time', endTime);
            formData.append('day', this.day.value);

            // Collect GenEd requirements
            const genEdCheckboxes = document.querySelectorAll('input[name="gen_ed_requirement"]:checked');
            let genEdValues = [];
            genEdCheckboxes.forEach((checkbox) => {
                genEdValues.push(checkbox.value);
            });
            formData.append('gen_ed_requirement', genEdValues.join(','));

            // Fetch request
            fetch('/get_courses', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if(data.error) {
                    coursesContainer.innerHTML = `<p>Error: ${data.error}</p>`;
                } else {
                    loadCourses(data);
                }
            })
            .catch(error => {
                console.error('Error fetching courses:', error);
                coursesContainer.innerHTML = '<p>Error loading courses.</p>';
            })
            .finally(() => {
                if (loadingIndicator) {
                    loadingIndicator.classList.add('hidden');
                }
            });
        });

        function loadCourses(coursesData) {
            const container = document.getElementById('courses-container');
            container.innerHTML = '';

            if (coursesData.length === 0) {
                container.innerHTML = '<p>No courses were found.</p>';
            } else {
                coursesData.forEach(course => {
                    const courseElement = document.createElement('div');
                    courseElement.classList.add('p-4', 'mb-2', 'border', 'border-gray-300', 'rounded');

                    const courseTitle = document.createElement('h3');
                    courseTitle.classList.add('text-lg', 'font-bold');
                    courseTitle.textContent = `${course.Course} - ${course.Name}`;

                    const courseTime = document.createElement('p');
                    courseTime.textContent = `Lecture Time: ${course.LectureTime}`;

                    const courseDays = document.createElement('p');
                    courseDays.textContent = `Lecture Days: ${course.LectureDays}`;

                    const courseGPA = document.createElement('p');
                    courseGPA.textContent = `Average GPA: ${course.AverageGPA}`;

                    const courseGenEds = document.createElement('p');
                    courseGenEds.textContent = `GenEd Requirements: ${course.GenEdRequirements.join(', ')}`;

                    courseElement.appendChild(courseTitle);
                    courseElement.appendChild(courseGenEds);
                    courseElement.appendChild(courseTime);
                    courseElement.appendChild(courseDays);
                    courseElement.appendChild(courseGPA);

                    if (course.Discussions.length > 0) {
                        const discussionsTitle = document.createElement('h4');
                        discussionsTitle.classList.add('text-md', 'font-semibold');
                        discussionsTitle.textContent = "Discussion Sessions:";
                        courseElement.appendChild(discussionsTitle);

                        course.Discussions.forEach(discussion => {
                            const discussionInfo = document.createElement('p');
                            discussionInfo.textContent = `Time: ${discussion.DiscussionTime}, Days: ${discussion.DiscussionDays}`;
                            courseElement.appendChild(discussionInfo);
                        });
                    }

                    container.appendChild(courseElement);
                });
            }
        }
                    
        // Call the fetch function when the DOM is fully loaded
        document.addEventListener('DOMContentLoaded', fetchAndDisplayCourses);
    </script>    
</body>
</html>
